import pandas as pd
import matplotlib.pyplot as plt
import numpy as np

df = pd.read_csv("gapminder.csv").dropna(
    subset=["gdp_per_capita", "life_expectancy", "continent"]
)
df = df[df["gdp_per_capita"] > 0].copy()

continents = sorted(df["continent"].unique())
cmap = plt.get_cmap("tab10")
color_map = {c: cmap(i % 10) for i, c in enumerate(continents)}

plt.figure()

for c in continents:
    d = df[df["continent"] == c]
    plt.scatter(
        d["gdp_per_capita"],
        d["life_expectancy"],
        s=14,
        alpha=0.4,
        label=c,
        c=[color_map[c]],
        edgecolors="none",
    )

plt.xscale("log")
plt.xlabel("GDP per Capita (log scale)")
plt.ylabel("Life Expectancy")
plt.title("Life Expectancy vs GDP per Capita (colored by continent)")
plt.legend(title="Continent", frameon=False)
plt.tight_layout()
plt.show()